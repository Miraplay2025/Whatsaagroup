<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Restore WhatsApp Session</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  background: linear-gradient(135deg,#00c6ff,#0072ff);
  font-family: Arial;
  padding:20px;
  color:#fff;
}
.card {
  max-width:420px;
  background:#fff;
  color:#000;
  padding:20px;
  border-radius:15px;
  margin:auto;
}
input, button {
  width:100%;
  padding:14px;
  margin-top:10px;
  border-radius:10px;
  border:none;
}
button {
  background:#0072ff;
  color:#fff;
}
.log {
  background:#111;
  color:#0f0;
  padding:10px;
  height:150px;
  overflow:auto;
  margin-top:15px;
}
.group {
  background:#f1f1f1;
  padding:10px;
  margin-top:5px;
  border-radius:8px;
}
</style>
</head>

<body>

<div class="card">
  <h2>Restaurar Sessão WhatsApp</h2>

  <input type="file" id="file">
  <input placeholder="Ou cole link do ZIP" id="url">

  <button onclick="restore()">Restaurar Sessão</button>

  <div class="log" id="log"></div>

  <div id="result"></div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
const logBox = document.getElementById('log');

function log(msg){
  logBox.innerHTML += msg + '<br>';
  logBox.scrollTop = logBox.scrollHeight;
}

function restore(){
  const file = document.getElementById('file').files[0];
  const url = document.getElementById('url').value;

  if (file) {
    socket.emit('restore-session', {
      type:'upload',
      file
    });
  } else if (url) {
    socket.emit('restore-session', {
      type:'url',
      url
    });
  } else {
    alert('Envie um ZIP ou link');
  }
}

socket.on('log', log);

socket.on('session-data', data => {
  const r = document.getElementById('result');
  r.innerHTML = `
    <h3>${data.name} (${data.number})</h3>
    <h4>Grupos</h4>
    ${data.groups.map(g => `
      <div class="group">
        ${g.name} - ${g.members} membros
      </div>
    `).join('')}
  `;
});
</script>

</body>
</html>
