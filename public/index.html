<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WhatsApp Session Manager</title>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:#fff;
  padding:20px;
}
.container {
  max-width:700px;
  margin:auto;
  background:#111;
  border-radius:12px;
  padding:20px;
}
input, textarea, button {
  width:100%;
  margin-top:10px;
  padding:12px;
  border-radius:8px;
  border:none;
}
button {
  background:#25D366;
  color:#000;
  font-weight:bold;
  cursor:pointer;
}
.logs {
  background:#000;
  padding:10px;
  margin-top:15px;
  height:200px;
  overflow:auto;
  font-size:14px;
}
.group {
  background:#1e1e1e;
  margin-top:8px;
  padding:8px;
  border-radius:6px;
}
</style>
</head>

<body>
<div class="container">
  <h2>WhatsApp Session</h2>

  <input id="driveLink" placeholder="Cole o link do ZIP (Google Drive)">
  <button onclick="start()">Conectar WhatsApp</button>

  <div class="logs" id="logs"></div>

  <h3>Enviar Mensagem</h3>
  <input id="number" placeholder="NÃºmero com DDD">
  <textarea id="message" placeholder="Mensagem"></textarea>
  <button onclick="sendMsg()">Enviar</button>

  <h3>Grupos</h3>
  <div id="groups"></div>
</div>

<script>
const socket = io('https://whatsaagroup.onrender.com');

function log(msg){
  const div = document.getElementById('logs');
  div.innerHTML += msg + '<br>';
  div.scrollTop = div.scrollHeight;
}

socket.on('log', log);

socket.on('session-info', data => {
  log('ðŸ“Š InformaÃ§Ãµes carregadas');
  document.getElementById('groups').innerHTML = '';
  data.groups.forEach(g => {
    document.getElementById('groups').innerHTML +=
      `<div class="group">ðŸ“Œ ${g.name} â€” ðŸ‘¥ ${g.members}</div>`;
  });
});

function start(){
  const link = document.getElementById('driveLink').value;
  socket.emit('start-from-drive', link);
}

function sendMsg(){
  socket.emit('send-message',{
    number: number.value,
    message: message.value
  });
}
</script>
</body>
</html>
